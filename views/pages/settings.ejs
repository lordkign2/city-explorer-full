<!-- ./views/pages/settings.ejs -->
<%- include('../partials/header') %>
<%- include('../partials/navbar') %>
<%- include('../partials/flashMessages') %>
<%- include('../partials/sidebar') %>

<section class="max-w-2xl mx-auto mt-10 p-6 bg-white dark:bg-gray-900 rounded-2xl shadow-lg">
  <h1 class="text-3xl font-bold mb-6 text-gray-800 dark:text-white text-center">User Settings</h1>

  <form action="/dashboard/settings" method="POST" class="space-y-6">
    <!-- Username -->
    <div>
      <label for="username" class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">Username</label>
      <input
        type="text"
        id="username"
        name="username"
        value="<%= user.username %>"
        required
        class="form-input w-full bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg border border-gray-300 dark:border-gray-700 focus:ring-2 focus:ring-indigo-500"
      />
    </div>

    <!-- Email -->
    <div>
      <label for="email" class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300">Email</label>
      <input
        type="email"
        id="email"
        name="email"
        value="<%= user.email %>"
        required
        class="form-input w-full bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg border border-gray-300 dark:border-gray-700 focus:ring-2 focus:ring-indigo-500"
      />
    </div>

    <!-- Avatar -->
    <div class="flex items-center mt-8 gap-4">
      <img
        src="<%= user.avatarUrl %>"
        alt="avatar"
        class="w-14 h-14 rounded-full border-2 border-indigo-500 object-cover"
        onerror="this.src='/images/avatar-placeholder.png'"
      />
      <p class="text-gray-600 dark:text-gray-400 text-sm leading-snug">
        Avatar is powered by 
        <a href="https://gravatar.com" target="_blank" class="text-indigo-600 dark:text-indigo-400 hover:underline">Gravatar</a>.<br />
        To update, change your email on <strong>Gravatar</strong>.
      </p>
    </div>

    <!-- Password Change -->
    <details class="mt-10 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4">
      <summary class="cursor-pointer text-indigo-600 dark:text-indigo-400 font-medium mb-2">Change Password</summary>
      <div class="mt-4 space-y-4">
        <div>
          <label for="currentPassword" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Current Password</label>
          <input
            type="password"
            id="currentPassword"
            name="currentPassword"
            class="form-input w-full bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg border border-gray-300 dark:border-gray-600"
            placeholder="Enter current password"
          />
        </div>
        <div>
          <label for="newPassword" class="block text-sm font-medium text-gray-700 dark:text-gray-300">New Password</label>
          <input
            type="password"
            id="newPassword"
            name="newPassword"
            class="form-input w-full bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg border border-gray-300 dark:border-gray-600"
            placeholder="Enter new password"
          />
        </div>
        <div>
          <label for="confirmPassword" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Confirm New Password</label>
          <input
            type="password"
            id="confirmPassword"
            name="confirmPassword"
            class="form-input w-full bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg border border-gray-300 dark:border-gray-600"
            placeholder="Confirm new password"
          />
        </div>
      </div>
    </details>

    <!-- Submit -->
    <button
      type="submit"
      class="w-full py-2 px-4 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold rounded-lg shadow transition duration-200 mt-6"
    >
      Save Changes
    </button>
  </form>
</section>

<%- include('../partials/footer') %>
