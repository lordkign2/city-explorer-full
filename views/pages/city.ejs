<%- include('../partials/header') %>
<%- include('../partials/navbar') %>
<%- include('../partials/flashMessages') %>

<section class="max-w-5xl mx-auto mt-10 p-6 bg-white dark:bg-gray-900 rounded-lg shadow-md">
  <!-- City Name -->
  <h1 class="text-4xl font-bold mb-6 text-gray-800 dark:text-white text-center">
    <%= city.name %>, <%= city.countryName %>
  </h1>

  <!-- Hero Image -->
  <div class="mb-8">
    <img src="<%= city.imageUrl %>" alt="<%= city.name %> image"
      class="w-full rounded-lg object-cover h-64 shadow" />
  </div>

  <!-- Weather Section -->
  <div class="mb-8">
    <h2 class="text-2xl font-semibold text-gray-700 dark:text-white mb-3">ğŸŒ¤ Current Weather</h2>
    <% if (weather) { %>
      <div class="text-gray-800 dark:text-gray-300 space-y-1">
        <p><%= weather.temperature %>Â°C â€” <%= weather.description %></p>
        <p>Wind Speed: <%= weather.wind %> mPh</p>
      </div>
    <% } else { %>
      <p class="text-red-500">Weather info unavailable</p>
    <% } %>
  </div>

  <!-- Photo Carousel -->
<!-- <div class="mb-8">
  <h2 class="text-2xl font-semibold text-gray-700 dark:text-white mb-3">ğŸ“· City Gallery</h2>
  <div class="swiper mySwiper rounded-lg overflow-hidden shadow">
    <div class="swiper-wrapper">
      <% //city.photos.forEach(photo => { %>
        <div class="swiper-slide">
          <img src="<%=// photo %>" alt="City photo" class="w-full h-64 object-cover">
        </div>
      <%// }) %>
    </div>
    <div class="swiper-pagination"></div>
  </div>
</div> -->

<!-- SwiperJS CDN -->
<!-- <link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
/>
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script>
  const swiper = new Swiper(".mySwiper", {
    loop: true,
    pagination: {
      el: ".swiper-pagination",
    },
    autoplay: {
      delay: 3500,
    },
  });
</script> -->


  <!-- Schools -->
  <div class="mb-8">
    <h2 class="text-2xl font-semibold text-gray-700 dark:text-white mb-3">ğŸ“ Educational Institutions</h2>
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
      <% schools.forEach(school => { %>
        <div class="bg-gray-100 dark:bg-gray-800 p-4 rounded-lg shadow">
          <p class="text-lg font-semibold text-gray-800 dark:text-white"><%= school.name %></p>
          <p class="text-sm text-gray-600 dark:text-gray-400"><%= school.address %></p>
        </div>
      <% }) %>
    </div>
  </div>

  <!-- Fun Facts -->
  <div class="mb-8">
    <h2 class="text-2xl font-semibold text-gray-700 dark:text-white mb-3">âœ¨ Fun Facts</h2>
    <ul class="list-disc pl-6 text-gray-700 dark:text-gray-300 space-y-1">
      <% city.funFacts.forEach(fact => { %>
        <li><%= fact %></li>
      <% }) %>
    </ul>
  </div>

  <!-- Map -->
  <div class="mb-8">
    <h2 class="text-2xl font-semibold text-gray-700 dark:text-white mb-3">ğŸ—ºï¸ Map</h2>
    <div id="map" class="w-full h-64 rounded-lg shadow"></div>
    <script>
      const map = L.map('map').setView([<%= city.lat %>, <%= city.lng %>], 12);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
      L.marker([<%= city.lat %>, <%= city.lng %>]).addTo(map).bindPopup('<%= city.name %>').openPopup();
    </script>
  </div>

  <!-- Chat -->
  <%- include('../partials/chat', { cityId, messages, user }) %>
</section>

<%- include('../partials/footer') %>
