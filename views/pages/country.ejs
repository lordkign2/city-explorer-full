<%- include('../partials/navbar') %>
<%- include('../partials/flashMessages') %>

<section class="max-w-5xl mx-auto mt-8 p-6 bg-white dark:bg-gray-900 rounded-lg shadow">
  <h1 class="text-4xl font-bold mb-4 text-gray-800 dark:text-white"><%= country.name %></h1>

  <!-- Country Info -->
  <div class="mb-6">
    <p class="text-lg text-gray-700 dark:text-gray-300"><strong>Code:</strong> <%= country.code %></p>
    <p class="text-lg text-gray-700 dark:text-gray-300"><strong>Region:</strong> <%= country.region || 'N/A' %></p>
    <p class="text-lg text-gray-700 dark:text-gray-300"><strong>Population:</strong> <%= country.population?.toLocaleString() || 'N/A' %></p>
    <p class="text-lg text-gray-700 dark:text-gray-300"><strong>Capital:</strong> <%= country.capital || 'N/A' %></p>
    <p class="text-lg text-gray-700 dark:text-gray-300"><strong>Currency:</strong> <%= country.currency || 'N/A' %></p>
  </div>

  <!-- Country Map -->
  <% if (country.latlng) { %>
    <div id="map" class="h-64 rounded mb-6 shadow"></div>
    <script>
      const map = L.map('map').setView([<%= country.latlng[0] %>, <%= country.latlng[1] %>], 5);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
      L.marker([<%= country.latlng[0] %>, <%= country.latlng[1] %>]).addTo(map)
        .bindPopup('<%= country.name %>')
        .openPopup();
    </script>
  <% } %>

  <!-- Cities in Country -->
  <div>
    <h2 class="text-2xl font-semibold text-gray-700 dark:text-white mb-3">Cities in <%= country.name %></h2>
    <% if (cities.length === 0) { %>
      <p class="text-gray-500 dark:text-gray-400">No cities added yet.</p>
    <% } else { %>
      <ul class="grid grid-cols-1 sm:grid-cols-2 gap-4">
        <% cities.forEach(city => { %>
          <li class="bg-gray-100 dark:bg-gray-800 p-4 rounded shadow">
            <h3 class="text-lg font-semibold text-gray-800 dark:text-white"><%= city.name %></h3>
            <a href="/cities/<%= city._id %>" class="text-indigo-600 dark:text-indigo-400 text-sm hover:underline">View</a>
          </li>
        <% }) %>
      </ul>
    <% } %>
  </div>
</section>

<%- include('../partials/footer') %>